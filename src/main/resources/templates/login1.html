<!DOCTYPE html>
<html lang="en"  xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Home</title>
    <!-- Meta tag Keywords -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8" />
    <meta name="keywords"
          content="Hotair Login Form Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
    <!-- //Meta tag Keywords -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;600;700;900&display=swap" rel="stylesheet">
    <!--/Style-CSS -->
    <link rel="stylesheet" href="css/backLogin_style.css" type="text/css" media="all" />
    <!--//Style-CSS -->

    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" media="all">

</head>

<body>

<!-- form section start -->
<section class="w3l-hotair-form">
    <h1>微博登陆</h1>
    <div class="container">
        <!-- /form -->
        <div class="workinghny-form-grid">
            <div class="main-hotair">
                <!--<div class="alert-close">-->
                    <!--<span class="fa fa-close"></span>-->
                <!--</div>-->
                <div class="content-wthree">
                    <h2>登陆</h2>
                    <p>你的账户</p>
                    <div id="left_name" style="width: 300px;">
                        <div >
                            <form action="/checkLogin" method="post">
                                <input type="text" class="text" name="name" placeholder="User Name" required="">
                                <input type="password" class="password" name="password" placeholder="User Password" required="">
                                <button class="namBtn" type="submit">登陆</button>
                            </form>
                        </div>
                        <p class="account" style="margin: 0px auto;">使用<a  onclick="change()" href="javascript:;">手机</a>登陆</p>
                        <div class="social-icons w3layouts">
                            <ul>
                                <li>
                                    <a href="#url" class="facebook"><span class="fa fa-facebook"></span> </a>
                                </li>
                                <li>
                                    <a href="#url" class="twitter"><span class="fa fa-twitter"></span> </a>
                                </li>
                                <li>
                                    <a href="#url" class="pinterest"><span class="fa fa-pinterest"></span> </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div id="left_phone" style="display:none; width: 300px;" >
                        <div style="display: inline-block;" >
                            <div >
                                <form action="/message" method="post">
                            <input type="text" placeholder="请输入手机号" id="memPhone" name="memPhone">
                            <input type="text" placeholder="请输入验证码" id="code" name="code" maxlength="6" style="display: inline;width: 50%;">
                            <input type="button" value="获取验证码" id="sendBtn" style= " font-size: 10px;border-color:#1e9fff !important;display: inline;width: 40%;" onclick="sendCode(this)"></input>
                            <button class="phoBtn" type="submit">登陆</button>
                                </form>
                            </div>
                        </div>

                        <p class="account"  style="margin: 0px auto;">使用<a  onclick="change()" href="javascript:;">密码</a>登陆</p>
                        <div class="social-icons w3layouts">
                            <ul>
                                <li>
                                    <a href="#url" class="facebook"><span class="fa fa-facebook"></span> </a>
                                </li>
                                <li>
                                    <a href="QQLogin" class="twitter"><span class="fa fa-twitter"></span> </a>

                                </li>
                                <li>
                                    <a href="#url" class="pinterest"><span class="fa fa-pinterest"></span> </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div id="left_register" style="width: 300px; display: none">
                        <div>
                                <input type="text"  name="name" id="username" placeholder="用户名" required="">
                                <input type="password" class="password" id="password" name="passwordFirst" placeholder="密码" required="">
                                <input type="password" class="repassword" id="repassword" name="password" placeholder="确认密码" required="">
                                <input type="text" name="phone" id="phone" placeholder="手机号" required="">
                                <button class="namBtn" type="submit" onclick="subRegst()">Register</button>
                        </div>
                        <p class="account">已注册账号，去 <a href="/" >登录</a></p>
                    </div>
                    <!--<a href="/QQLogin">qq登录</a>-->
                    <p class="account">没有账户？<a href="javascript:;" onclick="register()" >点我注册</a></p>
                </div>
                <!-- 右半部分 -->
                <div class="w3l_form align-self" style="width: 300px;">
                <div class="left_grid_info">

                </div>
            </div>
        </div>
    </div>
    <!-- //form -->
    </div>
    <!-- copyright-->
    <div class="copyright text-center">
        <p class="copy-footer-29">所有资源收集自网络，如有侵权请联系@Admin！<a target="_blank" href="https://sc.chinaz.com/moban/"></a></p>
    </div>
    <!-- //copyright-->
</section>
<!-- //form section start -->

<script src="js/jquery.min.js"></script>
<script>
    $(document).ready(function (c) {
        $('.alert-close').on('click', function (c) {
            $('.main-hotair').fadeOut('slow', function (c) {
                $('.main-hotair').remove();
            });
        });
    });
</script>
<script>
    //注册
    function register() {
        var regDispay=$("#left_register").css("display","block");
        var box=$(".content-wthree");
        box.html(regDispay)
    }
    function subRegst() {
        var name = $("#username").val();
        var password = $("#password").val();
        var repassword = $("#repassword").val();
        var phone=$("#phone").val();
        var reg_tel = /^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/;    //11位手机号码正则
        if(name==""){
            alert("请输入姓名")
        }else if(password==""){
            alert("请输入密码")
        }else  if(repassword==""){
            alert("请再次输入密码")
        }else  if(password!=repassword){
            alert("两次密码不一样")
        }else if(!reg_tel.test(phone)){
            alert("请输入正确的手机号！");
        }else if(reg_tel.test(phone)){
            $.ajax({
                type: 'post',
                url: '/phone',
                data: {
                    phone:phone
                },
                dataType: 'json',
                success: function(data) {
                    if(data===true){
                        $.ajax({
                            type: 'post',
                            url: '/register',
                            data: {
                                name : name,
                                password:repassword,
                                phone:phone
                            },
                            dataType: 'json',
                            success: function(data) {
                                if(data===1){
                                    alert("注册成功")
                                    name = $("#username").val("");
                                    password = $("#password").val("");
                                    repassword = $("#repassword").val("");
                                    phone=$("#phone").val("");
                                }else{
                                    alert("注册失败")
                                }
                            },
                            error: function(data) {
                                alert('连接超时！');
                            },
                        });
                    }else{
                        alert("该手机号已经注册")
                    }
                },
                error: function(data) {
                    alert('判断手机号是否注册失败！');
                },
            });
        }
    }
    //登录方式切换
    function change(){
        var pasDisplay=$("#left_name").css("display");
        var phoDispay=$("#left_phone").css("display");
        if(pasDisplay!="none"){
            $("#left_name").css("display","none")
            $("#left_phone").css("display","block")
        }
        if(phoDispay!="none"){
            $("#left_name").css("display","block")
            $("#left_phone").css("display","none")
        }
    }
</script>
<script type="text/javascript">
    function sendCode(){
        var memPhone = $("#memPhone").val();
        console.log(memPhone.length);
        if(memPhone == '' || memPhone.length != 11){
            alert("请输入正确的手机号！");
            return;
        }else{
            $.ajax({
                type: 'get',
                url: '/fitness/code',
                data: {
                    memPhone : memPhone
                },
                dataType: 'json',
                success: function(data) {
                    if(data){
                        timer();
                    }else{
                        alert("获取验证码失败");
                    }
                },
                error: function(data) {
                    alert('连接超时！');
                },
            });
        }
    }
    var wait = 60;
    //倒计时
    function timer() {
        if(wait == 0){
            $("#sendBtn").val("获取验证码");
            $("#sendBtn").removeAttr("disabled");
            $("#sendBtn").css("border-color","1e9fff").css("background", "#ffffff").css("cursor", "pointer");
            wait = 60;
        }else{
            $("#sendBtn").attr("disabled","true");
            $("#sendBtn").css("border-color","fbfbfb").css("background", "#ccc").css("cursor", "not-allowed");
            $("#sendBtn").val(wait + "秒后重发");
            wait--;
            setTimeout(function() {timer()}, 1000);
        }
    }
</script>

</body>

</html>