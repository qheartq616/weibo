<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<link rel="shortcut icon" href="/images/tx.jpg" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache">
	<meta http-equiv="Expires" content="0">
	<title th:text="|${session.user.name}的首页 微博-随时随地发现新鲜事|"></title>
	<meta name="keywords" content="司空琪个人微博,司空琪个人主页,司空琪空间,画江湖动漫" />
	<meta name="description" content="司空琪个人微博,司空琪个人主页,司空琪空间说说,画江湖动漫" />
	<style type="text/css">
		img.wp-smiley,
		img.emoji {
			display: inline !important;
			border: none !important;
			box-shadow: none !important;
			height: 1em !important;
			width: 1em !important;
			margin: 0 .07em !important;
			vertical-align: -0.1em !important;
			background: none !important;
			padding: 0 !important;
		}
	</style>
	<link rel='stylesheet' id='style-css' href='/css/style.css' type='text/css' media='all' />
	<link rel='stylesheet' id='lmlblog-css' href='/css/lmlblog.css' type='text/css' media='all' />
	<link rel='stylesheet' id='all-css' href='/css/all.css' type='text/css' media='all' />

	<!--<link rel="stylesheet" href="/css/bootstrap.min.css">-->
	<link rel="stylesheet" type="text/css" href="/css/style-input.css">

	<script type='text/javascript' src='/js/jquery.min.js'></script>
	<script type='text/javascript' src='/js/ueditor.all.min.js'></script>
</head>
<body>
<input hidden th:value="${session.user.uid}" id="uidVar">
<!-- 菜单 -->
<div class="menu-bar">
	<div class="head_content">
		<h1 class="m-logo"><a href="https://weibo.com/"></a></h1>

		<div id="nav" class="menu-menu-1-container">
			<ul id="menu-menu-1" class="menu" >
				<li id="head_search"><i class="fa fa-search"></i></li>
				<li class="menu-item" style="margin-left: 3px;">
					<form action="#" method=""  style="display: inline-block; ">
						<input type="search" style="display: inline-block;" class="search" placeholder="搜索框" />
					</form>
				</li>
				<li class="gengxin menu-item menu-item-type-custom">
					<a th:href="@{|/main/${session.user.uid}/all/1|}"><i class="fa fa-home"></i>微博首页</a>
				</li>
				<li class="menu-item"><a href="#1"><i class="fa fa-envelope-o"></i>私信</a></li>
				<li th:class="|menu-item menu-item-type-custom|">
					<a th:href="@{|/user/${session.user.uid}/1|}">
						<img th:src="|/avatar/${session.user.image}|" style="height: 32px;width: 32px;position: relative;top: -3px;" class="avatar" />
						<span th:text="${session.user.name}" style="display: inline-block;position: relative;top: -14px;"></span>
					</a>
				</li>
			</ul>

		</div>
		<!--<div class="head_user_info">
			<ul>
				<li id="head_login" onclick="#1">登录</li>
				<span class="head_login_middle">or</span>
				<li id="head_reg" onclick="#1">注册</li>
			</ul>
		</div>-->
		<div style="clear: both;"></div>
	</div>
</div><!-- menu-bar -->
<div style="clear: both;"></div>


<div class="lmlblog-member-main" data="1">
	<div class="lmlblog-member-bg-remove-image">

		<div class="lmlblog-member-content-list clear">
			<div class="lmlblog-member-left-main">
				<div class="lmlblog-member-left-profile">
					<h3>首页</h3>
					<ul>
						<li><i class="fa fa-address-book-o"></i><a th:href="@{|/main/${session.user.uid}/all/1|}">全部关注</a></li>
						<li><i class="fa fa-transgender"></i><a th:href="@{|/main/${session.user.uid}/latest/1|}">最新微博</a></li>
						<li><i class="fa fa-map-marker"></i><a href="#">特别关注</a></li>
						<li><i class="fa fa-smile-o"></i> <a  th:href="@{|/main/${session.user.uid}/mutual/1|}">好友圈</a></li>
					</ul>
				</div>
				<div class="lmlblog-member-left-profile">
					<h3>自定义分组 </h3>
					<ul th:each="group:${groupList}">
						<li>
							<i th:if="${group.gid==gid}" style="color: #ff8862;" class="fa fa-smile-o"></i>
							<i th:unless="${group.gid==gid}" class="fa fa-smile-o"></i>
							<a th:if="${group.gid==gid}" style="color: #ff8862;" th:href="@{|/main/${session.user.uid}/myGroups/${group.gid}/1|}" th:text="${group.name}">高校</a>
							<a th:unless="${group.gid==gid}" th:href="@{|/main/${session.user.uid}/myGroups/${group.gid}/1|}" th:text="${group.name}">高校</a>
						</li>
					</ul>
					<!--<div class="lmlblog-member-left-profile-hide" th:if="${groupList2.size()>0}">
						<ul th:each="group2:${groupList2}">
							<li><i class="fa fa-smile-o"></i><a th:href="@{|/main/${session.user.uid}/myGroups/${group2.gid}/1|}" th:text="${group2.name}">高校</a></li>
						</ul>
						<li><i class="fa fa-qq"></i> Q Q：<span>sikongqi-&#45;&#45;<span></li>
                        <li><i class="fa fa-wechat"></i> 微信：<span>天涯路远，一剑轻安。携琪之手，相伴江湖-&#45;&#45;<span></li>
                        <li><i class="fa fa-weibo"></i> 微博：<span>司空琪吧官博-&#45;&#45;<span></li>
					</div>
					<div class="lmlblog-member-left-profile-more" th:if="${groupList2.size()>0}">查看更多 <i class="fa fa-angle-right"></i></div>-->
				</div>

			</div>
			<div class="lmlblog-member-right-main">
				<div class="lmlblog-post-list">
					<div class="row" id="edit_form" >
						<span class="pull-left" style="margin:15px;">编写新鲜事</span>
						<span class="tips pull-right" style="margin:15px;"></span>
						<form role="form" style="margin-top: 50px;" method="post">
							<div class="form-group">
								<div class="col-sm-12" style="margin-left: 15px;margin-right: 15px;">
									<div contentEditable="true" id="content" class="form-control"></div>
								</div>
								<div class="col-sm-12" style="margin-top: 12px;margin-left: 12px;">
									<!--<span class="emoji" >表情</span>-->
									<span class="pic" >图片</span>
									<span>
										<input type="file" name="" class="select_Img" style="display: none" >
										<img class="preview" src="">
									</span>
									<!--<div class="myEmoji" >
										<ul id="myTab" class="nav nav-tabs">
											<li class="active">
												<a href="#set" data-toggle="tab">预设</a>
											</li>
											<li><a href="#hot" data-toggle="tab">热门</a></li>

										</ul>
										<div id="myTabContent" class="tab-content">
											<div class="tab-pane fade in active" id="set">
												<div class="emoji_1"></div>

											</div>
											<div class="tab-pane fade" id="hot">
												<div class="emoji_2"></div>
											</div>

										</div>
									</div>
									<span> <input type="file" id="selectImg" value=""></input> </span> -->
									<button type="button" id="send" class="btn btn-default pull-right disabled" style="position: relative;margin-right: 15px;">发布</button>
								</div>
							</div>
						</form>
					</div>

					<br>

					<div class="lmlblog-posts-list words" style="background-image:url(/images/058.png);"
						 data="4197" th:each="post:${pageInfo.list}" id="postList">

						<!-- 动态内容部分，包括列表 -->
						<div class="lmlblog-post-user-info">
							<div class="lmlblog-post-user-info-avatar" user-data="1">
								<a th:href="@{|/user/${post.user.uid}/1|}" style="display: inline-block;">
									<span class="lmlblog-vip-icon"></span>
									<img th:src="|/avatar/${post.user.image}|" class="avatar" />
									<i th:if="${post.user.status==0}" th:title="${post.user.name}"></i>
									<i th:if="${post.user.status==1}" class="lmlblog-verify lmlblog-verify-a" th:title="${post.user.name}"></i>
									<i th:if="${post.user.status==2}" class="lmlblog-verify lmlblog-verify-b" th:title="${post.user.name}"></i>
									<i th:if="${post.user.status==3}" class="lmlblog-verify lmlblog-verify-a" th:title="${post.user.name}"></i>
								</a>
								<div class="lmlblog-user-info-card">
									<div class="info_card_loading"><img src="/picture/chat-loading.gif">
										<p>资料加载中...</p>
									</div>
								</div>
							</div>

							<div class="lmlblog-post-user-info-name">
								<a th:href="@{|/user/${post.user.uid}/1|}">
									<font style="color:#333;font-weight:600" th:text="${post.user.name}">司空琪</font>
								</a>
								<!--<span class="lmlblog-mark lmlblog-lv" title="经验：3815">Lv.6</span><span
									class="lmlblog-mark lmlblog-vip">VIP 6</span>-->
							</div>
							<div class="lmlblog-post-user-info-time" title="2017-12-14 05:25" th:text="${#dates.format(post.postTime,'yyyy-MM-dd HH:mm')}">12-14 05:25</div>
							<div class="lmlblog-post-user-info-time" title="来自weibo.com" th:text="来自weibo.com">12-14 05:25</div>
						</div>

						<!-- 作者信息 -->
						<div class="lmlblog-post-setting">
							<i class="fa fa-angle-down"></i>
							<div class="lmlblog-post-setting-box">
								<ul>
									<a href="#" title="举报"><li>举报</li></a>
									<a href="#1" title="访问主页"><li>访问主页</li></a>
								</ul>
							</div>
						</div>

						<div class="lmlblog-post-content" th:text="${post.text}">
							<!--<a class="post_list_link" href="#">
								<P>　　疏星淡月，紫陌曲岸，持觞游赏，神移长川。一片彀纹，溶溶泄泄，忽而烟靡云敛。睹一丽人，缦立青水，云蒸雾霭，花衬善睐。荧荧兮若北辰之荣现，扰扰兮若紫玉之生烟。颜如舜华，迫闻素腰华琚摇;和颜静志，远望渌水呈雾绡。戏流光之夜蝶，采舞雪之琼花，流眷眷之眸光，润荣曜之笑靥。
								</P>
								<P>　　偶得美人回顾，思之朝朝暮暮。采芝兰以明愫，寄琼琚以作妆。余咏永慕叹道长，彼应影独愿偕芳。才知世有解语，不过琪语溯光。<img
										src="/images/66.png" alt="[s-65]" class="wp-smiley" />
									<img src="/images/8.png" alt="[s-65]" class="wp-smiley" />
								</P>
							</a>-->
						</div>

						<!--<div class="lmlblog-post-images-list clear">
							<a href="/images/qi01.jpg" data-fancybox="gallery"
							   data-caption='<i class="fa fa-copyright"></i> lmlblog'>
								<img src="/images/qi01.jpg" alt="司空琪吧十一月壁纸" /></a>
							<a href="/images/qi02.jpg" data-fancybox="gallery"
							   data-caption='<i class="fa fa-copyright"></i> lmlblog'>
								<img src="/images/qi02.jpg" alt="司空琪吧十一月壁纸" /></a>
							<a href="/images/qi03.jpg" data-fancybox="gallery"
							   data-caption='<i class="fa fa-copyright"></i> lmlblog'>
								<img src="/images/qi03.jpg" alt="司空琪吧十一月壁纸" /></a>
						</div>-->

						<div class="lmlblog-post-bar">
							<li onclick='list_comments_show(this);'>
								<i class="fa fa-comment-o"></i><span></span>
							</li>
							<li class="lmlblog-no-like" th:onclick="|javascript:doLike(${post.pid},${session.user.uid},this)|">
								<i class="fa fa-heart" th:if="${post.postLike==true}"></i><i class="fa fa-heart-o" th:if="${post.postLike==false}"></i><span th:text="|${post.countPostLike}|"></span>
							</li>
							<!--<li>
								<i class="lmlblog-icon">&#xe602;</i> <span>1.2w</span>
							</li>
							<li class="tag clear">
								<i class="lmlblog-icon">&#xe895;</i><a href="#2" title="司空琪壁纸"># 司空琪壁纸</a>
							</li>-->
						</div>
						<!--<div class="lmlblog-post-like-list">
							<a href="#17" id="had_like_11788">
								<img src="/picture/11.gif" class="avatar" /></a>
							<a href="#18" id="had_like_11499"><img src="/picture/12.gif"
																   class="avatar" /></a>
							<a href="#22" id="had_like_11488"><img src="/picture/20.png" class="avatar" />
								<i class="lmlblog-verify lmlblog-verify-a" title="认证信息：作者许仙白"></i></a><a
								href="#22" id="had_like_11477">
							<img src="/picture/13.gif" class="avatar" />
							<i class="lmlblog-verify lmlblog-verify-a" title="认证信息：168号计师"></i></a><a
								href="#22" id="had_like_1">
							<img src="/images/tx2.jpg" class="avatar" />
							<i class="lmlblog-verify lmlblog-verify-a" title="司空琪"></i></a>
						</div>-->
					<div class="lmlblog-post-footer-bar">
						<span th:title="${#dates.format(post.postTime,'yyyy-MM-dd HH:mm')}" th:text="${#dates.format(post.postTime,'yyyy-MM-dd HH:mm')}">12月14日 05:25</span>
						<span>小尾巴</span><i class="lmlblog-icon" onclick="lmlblog_post_type_open();">&#xe62c;</i>
					</div>

					</div>
					<!-- posts_list -->

					<!--<div class="lmlblog-pager"><a class="lmlblog-pager-left" href="#2">上一页</a>
						<div class="lmlblog-pager-center layui-form">
							<select>
								<option value="#=1">第 1 页</option>
								<option value="#=2">第 2 页</option>
								<option selected="selected" value="#3">第 3 页</option>
							</select>第 1 页
						</div>
						<a class="lmlblog-pager-right" href="#3">下一页</a>
					</div>-->
					<div class="lmlblog-pager" th:if="${#strings.isEmpty(gid)&&type!='all'}">
						<a class="lmlblog-pager-left" th:href="@{|/main/${session.user.uid}/${type}/${pageInfo.hasPreviousPage?pageInfo.prePage:1}|}">上一页</a>
						<div class="lmlblog-pager-center layui-form" th:text="|第${pageInfo.pageNum==0?1:pageInfo.pageNum}页|"></div>
						<a class="lmlblog-pager-right" th:href="@{|/main/${session.user.uid}/${type}/${pageInfo.hasNextPage?pageInfo.nextPage:pageInfo.navigateLastPage}|}">下一页</a>
					</div>
					<div class="lmlblog-pager" th:if="${not #strings.isEmpty(gid)}">
						<a class="lmlblog-pager-left" th:href="@{|/main/${session.user.uid}/myGroups/${gid}/${pageInfo.hasPreviousPage?pageInfo.prePage:1}|}">上一页</a>
						<div class="lmlblog-pager-center layui-form" th:text="|第${pageInfo.pageNum==0?1:pageInfo.pageNum}页|"></div>
						<a class="lmlblog-pager-right" th:href="@{|/main/${session.user.uid}/myGroups/${gid}/${pageInfo.hasNextPage?pageInfo.nextPage:pageInfo.navigateLastPage}|}">下一页</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
</div>
<!-- 底部 -->
<div style="clear:both"></div>
<div class="footer">
	<div class="footer_b_foot">
		<div class="footer_b_top">
		</div>
		<div class="footer_b_bottom">Design by 2017 画江湖杯莫停 司空琪个人主页 司空琪微博/空间/贴吧官博。Promoted by 2021 红桃QHeartQ。内容源于网络搜集，仅学习、分享交流。</div>
	</div>
</div>
<!-- 返回顶部 -->
<a href="javascript:returnTop();" class="cd-top"></a>
<script type="text/javascript">
	var sdelay = 0;

	function returnTop() {
		window.scrollBy(0, -100); //Only for y vertical-axis
		if (document.body.scrollTop > 0) {
			sdelay = setTimeout('returnTop()', 50);
		}
	}
</script>
</body>
<script type='text/javascript' src='/js/base.js'></script>
<script type='text/javascript' src='/js/all.js'></script>
<script type='text/javascript' src='/js/plupload.full.min.js'></script>
<script type='text/javascript' src='/js/layui.js'></script>

<script src="/js/jquery-3.1.0.js"></script>
<script src="/js/bootstrap.min.js"></script>

<script>
	jQuery(document).ready(function($) {
		$.fn.smartFloat = function() {
			var position = function(element) {
				var top = element.position().top,
						pos = element.css("position");
				$(window).scroll(function() {
					var scrolls = $(this).scrollTop();
					if (scrolls > top) {
						if (window.XMLHttpRequest) {
							element.css({
								position: "fixed",
								top: 0
							});
						} else {
							element.css({
								top: scrolls
							});
						}
					} else {
						element.css({
							position: "absolute",
							top: top
						});
					}
				});
			};
			return $(this).each(function() {
				position($(this));
			});
		};
		$(".lmlblog-member-left-bg-xg").smartFloat();
	});

	function doLike(pid,uid,d) {
		//alert("22");
		$.post(
				"/user/"+uid+"/doLike",
				"pid="+pid+"&uid="+uid,
				function (data){
					//alert("33");
					//应该还需要去改变post.like的值
					//alert(data);
					var a=$("#post"+pid+"0").text();
					var b=parseInt($(d).children().eq(1).text());
					var h="<i className='fa fa-heart'></i>";
					var ho="<i className='fa fa-heart-o'></i>";
					//alert(b);
					//alert(b-1);
					//alert(!data);
					if (!data){
						$(d).children().eq(0).removeClass("fa fa-heart");
						$(d).children().eq(0).addClass("fa fa-heart-o");
						$(d).children().eq(1).text(b-1);
					}else {
						$(d).children().eq(0).removeClass("fa fa-heart-o");
						$(d).children().eq(0).addClass("fa fa-heart");
						$(d).children().eq(1).text(b+1);
					}
				},
				"json"
		)
	}

	$(function(){
		$("#content").keyup(function(){
			//判断输入的字符串长度
			var content_len = $("#content").text().replace(/\s/g,"").length;

			$(".tips").text("已经输入"+content_len+"个字");

			if(content_len==0){
				// alert(content);
				$(".tips").text("");
				$("#send").addClass("disabled");
				return false;
			}else{
				$("#send").removeClass("disabled");
			}
		});

		$(".pic").click(function(){
			$(".select_Img").click();
		})

		// 	function confirm(){

		// 		var r= new FileReader();
		// f=$(".select_Img").files[0];
		// r.readAsDataURL(f);
		// r.onload=function(e) {
		// 	$(".preview").src=this.result;

		// };
		// 	}

		//点击按钮发送内容
		$("#send").click(function(){

			// var myDate = new Date();

			//   var min = myDate.getMinutes();

			//   var time = min-(min-1);

			//   //alert(time);

			var content=$("#content").text();

			//判断选择的是否是图片格式
			var imgPath = $(".imgPath").text();
			var start  = imgPath.lastIndexOf(".");
			var postfix = imgPath.substring(start,imgPath.length).toUpperCase();

			/*var mytime=time.toLocaleTimeString(); //获取当前时间
			time.toLocaleString( ); //获取日期与时间

			alert(mytime);*/

			var uid=$("#uidVar").val();

			//alert(uid);

			$.post(
					"/main/submit",
					"forwardPid=0&uid="+uid+"&text="+content+"&status=1",
					function (data) {
						/*var time1 = post.postTime.format("yyyy-MM-dd hh:mm:ss");
						alert(time1);*/
						var prependPost="<div class='lmlblog-posts-list words' style='background-image:url(/images/058.png);' ><div class='lmlblog-post-user-info'><div class='lmlblog-post-user-info-avatar' user-data='1'><a href='#1' style='display: inline-block;'><span class='lmlblog-vip-icon'></span><img src='/avatar/"+data.post.user.image+"' class='avatar' /><i class='lmlblog-verify lmlblog-verify-a' title="+data.post.user.name+"></i></a><div class='lmlblog-user-info-card'><div class='info_card_loading'><img src='/picture/chat-loading.gif'><p>资料加载中...</p></div></div></div><div class='lmlblog-post-user-info-name'><a href='#1'><font style='color:#333;font-weight:600' >"+data.post.user.name+"</font></a></div><div class='lmlblog-post-user-info-time' title='"+data.formatTime+"')} >刚刚</div><div class='lmlblog-post-user-info-time' title='来自weibo.com' >来自weibo.com</div></div><div class='lmlblog-post-setting'><i class='fa fa-angle-down'></i><div class='lmlblog-post-setting-box'><ul><a href='#' title='置顶'><li>置顶</li></a><a href='#' title='编辑'><li>编辑</li></a><a href='#1' title='删除'><li>删除</li></a></ul></div></div><div class='lmlblog-post-content' >"+data.post.text+"</div><div class='lmlblog-post-bar'><li onclick='list_comments_show(this);'><i class='fa fa-comment-o'></i><span></span></li><li class='lmlblog-no-like' onclick='javascript:doLike("+data.post.pid+","+uid+",this)'><i class='fa fa-heart-o'></i><span>"+data.post.countPostLike+"</span></li></div><div class='lmlblog-post-footer-bar'><span title='"+data.formatTime+"' >"+data.formatTime+"</span><span>小尾巴</span><i class='lmlblog-icon' onclick='lmlblog_post_type_open();'></i></div></div>";
						alert("发送成功！");
						$("#content").html("");
						$(".tips").text("");
						$("#postList").before(prependPost);
					},
					"json"
			);

			if(imgPath!=""){
				if(postfix!=".PNG"&&postfix!=".JPG"&&postfix!=".GIF"&&postfix!=".JPEG"){
					alert("图片格式需为png,gif,jpeg,jpg格式");
				}else{
					/*$(".item_msg").append("<div class='col-sm-12 col-xs-12 message' > <img src='/img/icon.png' class='col-sm-2 col-xs-2' style='border-radius: 50%'><div class='col-sm-10 col-xs-10'><span style='font-weight: bold;''>Jack.C</span> <br><small class='date' style='color:#999'>刚刚</small><div class='msg_content'>"+content+"<img class='mypic' onerror='this.src='/img/bg_1.jpg' src='/file:///"+imgPath+"' ></div></div></div>");*/

				}
			}else{
				/*$(".item_msg").append("<div class='col-sm-12 col-xs-12 message' > <img src='/img/icon.png' class='col-sm-2 col-xs-2' style='border-radius: 50%'><div class='col-sm-10 col-xs-10'><span style='font-weight: bold;''>Jack.C</span> <br><small class='date' style='color:#999'>刚刚</small><div class='msg_content'>"+content+"</div></div></div>");*/

			}

		});

		//添加表情包1
		for (var i = 1; i < 60; i++) {

			$(".emoji_1").append("<img src='/img/f"+i+".png' style='width:35px;height:35px' >");
		}
		//添加表情包2
		for (var i = 1; i < 61; i++) {

			$(".emoji_2").append("<img src='/img/h"+i+".png' style='width:35px;height:35px' >");
		}


		$(".emoji").click(function(){

			$(".myEmoji").show();

			//点击空白处隐藏弹出层
			$(document).click(function (e) {

				if (!$("#edit_form").is(e.target) && $("#edit_form").has(e.target).length === 0) {

					$(".myEmoji").hide();
				}
			});
		});

		//将表情添加到输入框
		$(".myEmoji img").each(function(){
			$(this).click(function(){
				var url = $(this)[0].src;

				$('#content').append("<img src='/"+url+"' style='width:25px;height:25px' >");

				$("#send").removeClass("disabled");
			})
		})

		//放大或缩小预览图片
		$(".mypic").click(function(){
			var oWidth=$(this).width(); //取得图片的实际宽度
			var oHeight=$(this).height(); //取得图片的实际高度

			if($(this).height()!=200){
				$(this).height(200);
			}else{
				$(this).height(oHeight + 200/oWidth*oHeight);

			}

		})

	})
</script>
</html>
